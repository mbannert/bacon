---
title: "Exploring R"
subtitle: "Applied Introduction to Programming "
author: "Matthias Bannert"
date: "28 Apr 2017"
output: ioslides_presentation
widescreen: true
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = FALSE)
```

## Overview

- warmup
- getting comfortable with your environment
- R programming tipps & conventions
- programming and data
- practice / advanced concepts 
- how to get help

## Declarative Fraction
```{r,echo=F,message=F,fig.width=10}
library(ggplot2)
library(reshape2)
library(likert)
library(intsvy)

# variable ST62Q13 codes familiarity with 'Declarative Fraction'
#tab <- pisa.table(variable="ST62Q13", by="ST04Q01", data=student2012)
load("../../data/pisa_tabbed.RData")
ptab <- acast(tab, ST04Q01~ST62Q13, value.var="Percentage")
ddat <- data.frame(Item=rownames(ptab), ptab)

# plot it with the likert package
likert.bar.plot(likert(summary=ddat),
                center=2) + ggtitle("Declarative Fraction") + theme_bw()
```
Source: Pisa study 2012.


## Warmup

- what's a *vector*,*matrix*, *data.frame*, *list*?
- what are (),[],{} good for ?
- some helpful shortcuts: 
  - [alt] + [-]:  nicely formatted assign operator
  - [alt] + [shift] + [k]: short cut overview
  - [ctrl] + [1]: jump to script window
  - [ctrl] + [2]: jump to console
  - [cmd] + [i]: format/indent code 
  


## Get familiar with your working environment

- R Studio IDE
- work with projects (.Rproj)
- folder structure: 
    - data 
    - R
    - man
    - inst
- conventions: avoid spaces, ugly characters in file names, ... 
- comment on your work (why, not what !)

## Good habits: Snakes ... 

- i_am_a_snake

<div align="right">
<img src="snake.png" alt="matthias bannert" style="width: 400px;"/></div>


## and camels

- jeSuisUnCamel

<div align="right">
<img src="camel.gif" alt="matthias bannert" style="width: 400px;"/></div>


## Function definitions and function calls

Define a function
```{r,echo=T}
# doUselessStuff = name
# a,b,x input parameters
# { function body }
doUseLessStuff <- function(a,b,x){
  (a + b)*x
}
```

Run a function
```{r,echo=T}
doUseLessStuff(10,20,3)
```

=> Let's define our own functions!

## Document a function with roxygen2

```{r,eval=F,echo=T}
#' Mickey Mouse computation
#' 
#' Sum of a and b multiplied by x. 
#' 
#' @author Matthias Bannert
#' @param a numeric vector, first element of the sum
#' @param b numeric vector, second element of the sum
#' @param x numeric multiplier
#' @examples doUselessStuff(10,20,10)
#' 
#' @return numeric 
#' @export 
doUseLessStuff <- function(a,b,x){
  (a + b)*x
}
```

## Understanding by doing 

Explore the basics of scoping
- try to define objects inside and outside of functions
- use both types of objects outside of functions
- explain potential problems

The not so basic answer:
[How R searches and finds stuff](http://blog.obeautifulcode.com/R/How-R-Searches-And-Finds-Stuff/)


## Development and Debugging 101

- start with a script
- turn script to function
- make sure to understand scoping (global variables)
- use debugger / or breakpoints

## How to get help: sources

- ?functionName
- vignettes
- [Hadley Wickham ggplot2 documentation](http://ggplot2.tidyverse.org/reference/)
- [R Bloggers](https://www.r-bloggers.com)
- [R Bloggers Tutorials for learning R](https://www.r-bloggers.com/how-to-learn-r-2/)
- [Stackoverflow tagged R](http://stackoverflow.com/questions/tagged/r)
- [R mailing lists](https://www.r-project.org/mail.html)


## How to set up a reproducible example

- data: standard dataset, simulation 
- be minimalistic: limit dependencies
- (system) info 
- **dput(dataObject)**

See also: [Stackoverflow How to set up ... ](http://stackoverflow.com/questions/5963269/how-to-make-a-great-r-reproducible-example)


## Programming and data 

- R specific binary (.RData)
- text based standard (.csv, fixed width, .json)
- propietary formats (.dta, .xlsx)
- databases (PostgreSQL, SQL Server, Oracle, MySQL, Cassandra, MongoDB, sqlite, ...)

=> task: find some interesting data and get in R! 

- psychology
- politics: French, U.S. elections
- sports 
- macroeconomics
- geospatial data

## Applied R (practice overview)

- lapply
- anonymous functions
- practice with data (mlb dataset)
- ggplot2 

**Advanced topic: various ecosystems inside R**

- tidyverse aka hadleyverse
- data.table
- different OO approaches: S3, S4, RC, ... 






## Git Version Control 101





## Packaging in a nutshell

- package: group of functions documented in context aware fashion  (?functionName)

- folder based organization of source code: data, man,
inst, src, R, (vignettes)

- NAMESPACE file (auto generated by roxygen2)

- DESCRIPTION file

- compilation


## Resources


- [Rpubs mbannert - practice](https://rpubs.com/mbannert)

- [Roger D. Peng R Programming for Data Science](https://bookdown.org/rdpeng/rprogdatascience/r-nuts-and-bolts.html)

- [Hadley Wickham Style Guide](http://adv-r.had.co.nz/Style.html)

- [Hadley Wickham R Packages](http://r-pkgs.had.co.nz/)

- [Official Documentation](https://cran.r-project.org/doc/manuals/r-release/R-exts.html)


